{% extends "base.html" %}
{% block content %}
  <h2>Cadastro de Paciente</h2>

  <form action="{{ url_for('main.new_patient') }}" method="POST" class="form">
    <label>Nome *</label>
    <input type="text" name="nome" required>

    <label>Rua</label>
    <input type="text" name="endereco_rua">

    <label>Bairro</label>
    <input type="text" name="endereco_bairro">

    <label>Número</label>
    <input type="text" name="endereco_numero">

    <label>Complemento</label>
    <input type="text" name="endereco_complemento">

    <label>Cidade</label>
    <input type="text" name="endereco_cidade">

    <label>UF</label>
    <input type="text" name="endereco_uf" maxlength="2">

    <label>CEP</label>
    <input type="text" name="endereco_cep">

    <label>Telefone</label>
    <input type="text" name="telefone">

    <label>Email</label>
    <input type="email" name="email">

    <button type="submit">Cadastrar paciente</button>
  </form>

  <hr>

  <h3>Pacientes Cadastrados</h3>

  <ul>
    {% if pacientes and pacientes|length > 0 %}
      {% for p in pacientes %}
        <li style="display:flex; align-items: center; gap:12px; margin-bottom:8px;">
          <div style="flex:1;">
            <strong>{{ p.nome }}</strong>
            {% if p.telefone %} — {{ p.telefone }}{% endif %}
            <small style="color:#666"> (ID: {{ p.id }})</small>
          </div>

          <!-- Form de exclusão: usa POST para sua rota @bp.post -->
          <form
            action="{{ url_for('main.excluir_paciente_route', id=p.id) }}"
            method="POST"
            onsubmit="return confirm('Tem certeza que deseja excluir o paciente {{ p.nome }}?');"
            style="margin:0;"
          >
            <button type="submit" style="background:#e74c3c;color:#fff;border:none;padding:6px 10px;border-radius:6px;cursor:pointer;">
              Excluir
            </button>
          </form>
        </li>
      {% endfor %}
    {% else %}
      <li>Nenhum paciente cadastrado.</li>
    {% endif %}
  </ul>
{% endblock %}
